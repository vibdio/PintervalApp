/* グレースケール切替ラベル（他のラベルと統一） */
.toggle-label {
  font-size: 12px;
  color: var(--muted);
  font-family: inherit;
}
/* ============================================
   ★ カウントダウン縦バー（右カラム）
============================================ */
.countdown-bar-container {
  position: absolute;
  top: 0;
  right: 0;
  width: 8px;
  height: 100%; /* ビューワの高さと同じ */
  background: rgba(255,255,255,0.08);
  /* 角丸なし */
  display: flex;
  align-items: flex-end;
  justify-content: center;
  z-index: 20;
  pointer-events: none;
}
.viewer-bar {
  right: 0;
  top: 0;
}
.countdown-bar {
  width: 4px;
  background: #fff;
  border-radius: 0;
  transition: height 0.3s cubic-bezier(.4,2,.6,1);
  height: 100%;
}
.viewer {
  position: relative;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,'Noto Sans JP',sans-serif}
:root{
  --left-w: 15vw;
  --right-w: 22vw;
  --bg: #0f1115;
  --fg: #e8eaed;
  --muted: #9aa0a6;
  --accent: #4f8cff;
  --panel: #171a21;
  --border: #2b2f3a;
  --button: #222631;
}
body{background:var(--bg);color:var(--fg)}

.layout{
  display:grid;
  grid-template-columns: var(--left-w) 1fr var(--right-w);
  grid-template-rows: 100vh;
}

.col{padding:16px;border-right:1px solid var(--border);overflow:auto}
.col.right{border-right:none;border-left:1px solid var(--border)}

/* ============================================
   ★ 中央カラムの高さを安定化（viewer を縮めない）
============================================ */
.col.center{
  padding:16px;
  border-right:1px solid var(--border);
  overflow:hidden;        /* ← viewer の高さが潰れないように */
  display:flex;           /* ← viewer を縦方向に伸ばせる */
  flex-direction:column;
}

.app-title{
  margin: 0 0 12px 0;
  font-size: 28px;
  letter-spacing: 0.4px;
  text-align: center;
}

.field{margin-bottom:16px;display:flex;flex-direction:column;gap:6px}
.field.readonly .counter{padding:8px 12px;border:1px dashed var(--border);border-radius:8px;background:var(--panel);min-height:38px;display:flex;align-items:center}
label{font-size:12px;color:var(--muted)}
input,select{padding:10px 12px;border-radius:8px;border:1px solid var(--border);background:var(--panel);color:var(--fg);outline:none}
input:disabled,select:disabled{opacity:0.6}
.btn{padding:10px 12px;border:none;border-radius:10px;background:var(--button);color:var(--fg);cursor:pointer}
.btn.primary{background:var(--accent);color:#fff}
.btn-primary {
  background: #18305a !important; /* 暗い青 */
  color: #fff !important;
}
.btn:disabled{opacity:0.6;cursor:not-allowed}
.note{color:var(--muted);font-size:12px}

/* ============================================
   ★ Toggle switch (カラー / グレースケール)
============================================ */
.toggle-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}
.toggle-text{
  font-size:12px;
  color:var(--muted);
  white-space:nowrap;
}
.switch{
  position:relative;
  display:inline-block;
  width:46px;
  height:24px;
  flex:0 0 auto;
}
.switch input{
  opacity:0;
  width:0;
  height:0;
}
.slider{
  position:absolute;
  inset:0;
  cursor:pointer;
  background:#2a2f3a;
  border:1px solid var(--border);
  border-radius:999px;
  transition: background .18s ease;
}
.slider:before{
  position:absolute;
  content:"";
  width:18px;
  height:18px;
  left:3px;
  top:50%;
  transform:translateY(-50%);
  background:#fff;
  border-radius:50%;
  transition: transform .18s ease;
}
.switch input:checked + .slider{
  background:var(--accent);
}
.switch input:checked + .slider:before{
  transform: translateX(22px) translateY(-50%);
}
.switch input:focus-visible + .slider{
  outline:2px solid rgba(79,140,255,.6);
  outline-offset:2px;
}
.switch input:disabled + .slider{
  opacity:.6;
  cursor:not-allowed;
}

/* ============================================
   ★ ビューワ（画像枠）を縦最大化
============================================ */
.viewer{
  position:relative;
  width:100%;
  flex:1;                 /* ← 親の空き高さをすべて占有！ */
  display:flex;
  align-items:center;
  justify-content:center;
  background:var(--bg);
  background:var(--bg);
  overflow:hidden;
}

/* ============================================
   ★ 複数画像表示グリッド
   - --grid-n (1/2/3/4) に応じて等分
============================================ */
.viewer-grid{
  position:absolute;
  inset:0;
  display:grid;
  grid-template-columns: repeat(var(--grid-n, 1), 1fr);
  grid-template-rows: repeat(var(--grid-n, 1), 1fr);
  gap:6px;
  padding:10px;
  box-sizing:border-box;
}

.viewer-grid img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
}

/* ============================================
   ★ 画像を最大サイズでフィット表示
============================================ */
/* 旧: viewer 直下の img は使わず、viewer-grid 内で表示 */

.controls{position:absolute;left:50%;bottom:24px;transform:translateX(-50%);display:flex;gap:14px;opacity:0;transition:opacity .2s ease}
.viewer:hover .controls{opacity:1}
.ctrl{font-size:20px;width:48px;height:48px;border-radius:24px;border:none;background:rgba(0,0,0,.55);color:#fff;backdrop-filter: blur(4px);cursor:pointer}
.ctrl:hover{background:rgba(0,0,0,.75)}

/* mobile hamburger bar (viewer overlay) */
.mobile-menubar{
  position:absolute;
  top:12px;
  left:12px;
  right:12px;
  display:none;
  justify-content:space-between;
  gap:12px;
  z-index:10;
  pointer-events:none; /* ボタン以外は透過 */
}
.hamburger{
  pointer-events:auto;
  width:44px;
  height:44px;
  border-radius:22px;
  border:1px solid rgba(255,255,255,.15);
  background:rgba(0,0,0,.55);
  color:#fff;
  font-size:22px;
  cursor:pointer;
  backdrop-filter: blur(4px);
}
.hamburger:hover{background:rgba(0,0,0,.75)}

.drawer-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  z-index:55;
}

.drawer-close{
  display:none;
  position:sticky;
  top:8px;
  margin-left:auto;
  width:40px;
  height:40px;
  border-radius:20px;
  border:1px solid var(--border);
  background:var(--button);
  color:var(--fg);
  cursor:pointer;
}

.countdown-wrap{display:flex;flex-direction:column;align-items:center;padding:8px 0 16px;border-bottom:1px solid var(--border);margin-bottom:12px}
.countdown-label{font-size:12px;color:var(--muted);margin-bottom:8px}
.countdown{font-size:44px;font-weight:700;letter-spacing:1px}

.history-head{display:flex;justify-content:space-between;align-items:center;margin:6px 0 10px 0;color:var(--muted)}
.badge{padding:2px 8px;border-radius:999px;background:#2a2f3a;color:#fff;font-size:12px}
.thumbs{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.thumbs img{width:100%;aspect-ratio:1/1;object-fit:cover;border-radius:6px;opacity:.9;border:1px solid var(--border)}
.thumbs img:hover{opacity:1;border-color:#3a4150;cursor:pointer}

@media (max-width: 1024px){
  :root{ --left-w: 26vw; --right-w: 26vw; }
}

/* =====================================================
   縦長（モバイル/狭幅）: 左/右カラムをドロワー化して
   基本はビューワのみ表示
===================================================== */
@media (max-width: 900px), (max-aspect-ratio: 1/1){
  .layout{ grid-template-columns: 1fr; grid-template-rows: 100vh; }

  /* viewer を常にフルハイトに */
  .col.center{ padding:0; border-right:none; }
  .viewer{ height:100vh; }

  /* タッチ環境でも操作ボタンを常時表示 */
  .controls{ opacity:1; }
  .viewer:hover .controls{ opacity:1; }

  /* ドロワー（左/右） */
  .col.left,
  .col.right{
    position:fixed;
    top:0;
    bottom:0;
    width:min(86vw, 380px);
    max-width:420px;
    background:var(--panel);
    overflow:auto;
    z-index:60;
    border:none;
    padding:16px;
    transition: transform .22s ease;
    box-shadow: 0 10px 30px rgba(0,0,0,.35);
  }

  .col.left{ left:0; transform: translateX(-110%); }
  .col.right{ right:0; transform: translateX(110%); }

  body.drawer-open-left .col.left{ transform: translateX(0); }
  body.drawer-open-right .col.right{ transform: translateX(0); }

  /* 片側を開く時は反対側を確実に格納 */
  body.drawer-open-left .col.right{ transform: translateX(110%); }
  body.drawer-open-right .col.left{ transform: translateX(-110%); }

  .mobile-menubar{ display:flex; }
  .drawer-close{ display:block; }
}

.login-area{padding:12px;border-bottom:1px solid var(--border);}
#loginBtn {
  width: 100%;
  padding: 10px 12px;
  font-size: 14px;
  border: none;
  border-radius: 10px;
  cursor: pointer;
}


/* Ensure hidden attribute actually hides elements (override global img{display:block}) */
[hidden]{ display:none !important; }

/* gap countdown overlay */
.gap-countdown {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 96px;
  font-weight: bold;
  color: #ffffff;
  background: rgba(0,0,0,0.6);
  z-index: 5;
}
.gap-countdown.hidden {
  display: none;
}
